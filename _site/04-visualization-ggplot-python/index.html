






<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta http-equiv="last-modified" content="2023-10-17 15:39:28 +0100">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- meta "search-domain" used for google site search function google_search() -->
    <meta name="search-domain" value="">
    <link rel="stylesheet" type="text/css" href="/assets/css/bootstrap.css" />
    <link rel="stylesheet" type="text/css" href="/assets/css/bootstrap-theme.css" />
    <link rel="stylesheet" type="text/css" href="/assets/css/lesson.css" />
    <link rel="stylesheet" type="text/css" href="/assets/css/syntax.css" />
    
    <link rel="license" href="#license-info" />

    



    <!-- Favicons for everyone -->
    <link rel="apple-touch-icon-precomposed" sizes="57x57" href="/assets/favicons/dc/apple-touch-icon-57x57.png" />
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="/assets/favicons/dc/apple-touch-icon-114x114.png" />
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="/assets/favicons/dc/apple-touch-icon-72x72.png" />
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/assets/favicons/dc/apple-touch-icon-144x144.png" />
    <link rel="apple-touch-icon-precomposed" sizes="60x60" href="/assets/favicons/dc/apple-touch-icon-60x60.png" />
    <link rel="apple-touch-icon-precomposed" sizes="120x120" href="/assets/favicons/dc/apple-touch-icon-120x120.png" />
    <link rel="apple-touch-icon-precomposed" sizes="76x76" href="/assets/favicons/dc/apple-touch-icon-76x76.png" />
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="/assets/favicons/dc/apple-touch-icon-152x152.png" />
    <link rel="icon" type="image/png" href="/assets/favicons/dc/favicon-196x196.png" sizes="196x196" />
    <link rel="icon" type="image/png" href="/assets/favicons/dc/favicon-96x96.png" sizes="96x96" />
    <link rel="icon" type="image/png" href="/assets/favicons/dc/favicon-32x32.png" sizes="32x32" />
    <link rel="icon" type="image/png" href="/assets/favicons/dc/favicon-16x16.png" sizes="16x16" />
    <link rel="icon" type="image/png" href="/assets/favicons/dc/favicon-128.png" sizes="128x128" />
    <meta name="application-name" content="Data Carpentry - Data Analysis and Visualization in Python for Ecologists"/>
    <meta name="msapplication-TileColor" content="#FFFFFF" />
    <meta name="msapplication-TileImage" content="/assets/favicons/dc/mstile-144x144.png" />
    <meta name="msapplication-square70x70logo" content="/assets/favicons/dc/mstile-70x70.png" />
    <meta name="msapplication-square150x150logo" content="/assets/favicons/dc/mstile-150x150.png" />
    <meta name="msapplication-wide310x150logo" content="/assets/favicons/dc/mstile-310x150.png" />
    <meta name="msapplication-square310x310logo" content="/assets/favicons/dc/mstile-310x310.png" />


    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
	<script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
	<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
	<![endif]-->

  <title>
  Making Plots With matplotlib/seaborn &ndash; Data Analysis and Visualization in Python for Ecologists
  </title>

  </head>
  <body>

    
















    <div class="container">
      
















  
  










<nav class="navbar navbar-default">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      
      
      <a href="https://datacarpentry.org" class="pull-left">
        <img class="navbar-logo" src="/assets/img/dc-icon-black.svg" alt="Data Carpentry logo" />
      </a>
      

      
      <a class="navbar-brand" href="/index.html">Home</a>

    </div>
    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <ul class="nav navbar-nav">

	
        <li><a href="/CODE_OF_CONDUCT.html">Code of Conduct</a></li>

        
	
        <li><a href="/setup.html">Setup</a></li>

        
        
        <li class="dropdown">
          <a href="/" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Episodes <span class="caret"></span></a>
          <ul class="dropdown-menu">
            
            
            <li><a href="/00-before-we-start/index.html">Before we start</a></li>
            
            
            <li><a href="/01-short-introduction-to-Python/index.html">Short Introduction to Programming in Python</a></li>
            
            
            <li><a href="/02-starting-with-data/index.html">Starting With Data</a></li>
            
            
            <li><a href="/03-index-slice-subset/index.html">Indexing, Slicing and Subsetting DataFrames in Python</a></li>
            
            
            <li><a href="/04-visualization-ggplot-python/index.html">Making Plots With matplotlib/seaborn</a></li>
            
            
            <li><a href="/05-loops-and-functions/index.html">Data Workflows and Automation</a></li>
            
            
            <li><a href="/07-visualization-ggplot-python/index.html">Making Plots With matplotlib/seaborn</a></li>
            
	    <li role="separator" class="divider"></li>
            <li><a href="/aio/index.html">All in one page (Beta)</a></li>
          </ul>
        </li>
        
	

	
	
        <li class="dropdown">
          <a href="/" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Extras <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="/reference.html">Reference</a></li>
            
            
            
              <li><a href="/CONTRIBUTORS/index.html">About Contributors</a></li>
            
            
            
            
              <li><a href="/about/index.html">About</a></li>
            
            
            
            
              <li><a href="/discuss/index.html">Discussion</a></li>
            
            
            
            
              <li><a href="/extra_challenges/index.html"> Extra Challenges</a></li>
            
            
            
            
              <li><a href="/figures/index.html">Figures</a></li>
            
            
            
            
              <li><a href="/guide/index.html">Instructor Notes</a></li>
            
            
            
            
              <li><a href="/jupyter_notebooks/index.html">Overview of Jupyter Notebooks</a></li>
            
            
          </ul>
        </li>
	

	
        <li><a href="/LICENSE.html">License</a></li>
        

        
	<li><a href="/edit//_episodes/04-visualization-ggplot-python.md" data-checker-ignore>Improve this page <span class="glyphicon glyphicon-pencil" aria-hidden="true"></span></a></li>
	
      </ul>
      <form class="navbar-form navbar-right" role="search" id="search" onsubmit="google_search(); return false;">
        <div class="form-group">
          <input type="text" id="google-search" placeholder="Search..." aria-label="Google site search">
        </div>
      </form>
    </div>
  </div>
</nav>



















  
  











<div class="row">
  <div class="col-xs-1">
    <h3 class="text-left">
      
      <a href="/03-index-slice-subset/index.html"><span class="glyphicon glyphicon-menu-left" aria-hidden="true"></span><span class="sr-only">previous episode</span></a>
      
    </h3>
  </div>
  <div class="col-xs-10">
    
    <h3 class="maintitle"><a href="/">Data Analysis and Visualization in Python for Ecologists</a></h3>
    
  </div>
  <div class="col-xs-1">
    <h3 class="text-right">
      
      <a href="/05-loops-and-functions/index.html"><span class="glyphicon glyphicon-menu-right" aria-hidden="true"></span><span class="sr-only">next episode</span></a>
      
    </h3>
  </div>
</div>

<article>
<div class="row">
  <div class="col-md-1">
  </div>
  <div class="col-md-10">
    <h1 class="maintitle">Making Plots With matplotlib/seaborn</h1>
  </div>
  <div class="col-md-1">
  </div>
</div>












<blockquote class="objectives">
  <h2>Overview</h2>

  <div class="row">
    <div class="col-md-3">
      <strong>Teaching:</strong> 40 min
      <br/>
      <strong>Exercises:</strong> 50 min
    </div>
    <div class="col-md-9">
      <strong>Questions</strong>
      <ul>
	
	<li><p>How can I visualize data in Python?</p>
</li>
	
      </ul>
    </div>
  </div>

  <div class="row">
    <div class="col-md-3">
    </div>
    <div class="col-md-9">
      <strong>Objectives</strong>
      <ul>
	
	<li><p>Create default <code class="language-plaintext highlighter-rouge">seaborn</code> plots</p>
</li>
	
	<li><p>Set universal plot settings.</p>
</li>
	
	<li><p>Modify existing plots.</p>
</li>
	
	<li><p>Change the aesthetics of a plot such as color.</p>
</li>
	
	<li><p>Edit the axis labels.</p>
</li>
	
	<li><p>Build complex plots using a step-by-step approach.</p>
</li>
	
	<li><p>Create scatter plots, box plots, and time series plots.</p>
</li>
	
	<li><p>Create customized plot styles to meet their needs.</p>
</li>
	
      </ul>
    </div>
  </div>

</blockquote>

<p>Python has powerful built-in plotting capabilities with the <code class="language-plaintext highlighter-rouge">matplotlib</code> library.
For this episode, we will be using the [<code class="language-plaintext highlighter-rouge">seaborn</code>][https://seaborn.pydata.org/]
package, which is built on top of Matplotlib and interacts well with Pandas.</p>

<p>Just as with the other packages, <code class="language-plaintext highlighter-rouge">seaborn</code> needs to be imported. Here we will import
both <code class="language-plaintext highlighter-rouge">matplotlib</code> and <code class="language-plaintext highlighter-rouge">seaborn</code>. It is good
practice to not just load an entire package such as <code class="language-plaintext highlighter-rouge">from seaborn import *</code>,
but to use an abbreviation as we used <code class="language-plaintext highlighter-rouge">pd</code> for Pandas:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="n">sns</span>
</code></pre></div></div>

<p>From now on, the functions of <code class="language-plaintext highlighter-rouge">seaborn</code> are available using <code class="language-plaintext highlighter-rouge">sns.</code> and matplotlib as <code class="language-plaintext highlighter-rouge">plt.</code>.
For the exercise, we will use the <code class="language-plaintext highlighter-rouge">surveys.csv</code> data set, with the <code class="language-plaintext highlighter-rouge">NA</code> values removed</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>

<span class="n">surveys_complete</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">'data/surveys.csv'</span><span class="p">)</span>
<span class="n">surveys_complete</span> <span class="o">=</span> <span class="n">surveys_complete</span><span class="p">.</span><span class="n">dropna</span><span class="p">()</span>
</code></pre></div></div>

<h2 id="plotting-with-matplotlibseaborn">Plotting with matplotlib/seaborn</h2>

<p>The <code class="language-plaintext highlighter-rouge">seaborn</code> package supports the creation of complex plots from data in a
dataframe. It uses default settings, which help creating publication quality
plots with a minimal amount of settings and tweaking.</p>

<p>Before we use the <code class="language-plaintext highlighter-rouge">seaborn</code> package, let’s just do the simplest plot we can do in Python
using the built-in <code class="language-plaintext highlighter-rouge">matplotlib</code>. Most plots in matplotlib are based on explicitly passing the arrays for the x-values
and y-values that will make up the points or lines of the plots. For example, to plot the weight versus the hindfoot length
from our surveys data we will need to extract them from the dataframe and pass them to the plotting function:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plt</span><span class="p">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">surveys_complete</span><span class="p">[</span><span class="s">"weight"</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">surveys_complete</span><span class="p">[</span><span class="s">"hindfoot_length"</span><span class="p">])</span>
</code></pre></div></div>
<p><img src="../fig/matplotlib_scatter.png" alt="test" /></p>

<p>Because <code class="language-plaintext highlighter-rouge">seaborn</code> integrates well with pandas we can define our data object (the dataframe) and then assign column names to
x and y values of the plot. So the same thing with seaborn is:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sns</span><span class="p">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">surveys_complete</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s">"weight"</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">"hindfoot_length"</span><span class="p">)</span>
</code></pre></div></div>

<p><img src="../fig/seaborn_scatter.png" alt="" /></p>

<h2 id="building-your-plots-iteratively">Building your plots iteratively</h2>

<p>Building plots and interactive visualisation is typically an iterative process.
So we would plot something initially but then depending on the results modify various
parameters to, for example, see more clearly what we want.</p>

<p>We start by the same scatterplot we did before:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sns</span><span class="p">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">surveys_complete</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s">"weight"</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">"hindfoot_length"</span><span class="p">)</span>
</code></pre></div></div>

<p><img src="../fig/seaborn_scatter.png" alt="" /></p>

<p>Then, we start modifying this plot to extract more information from it. For
instance, we can add transparency (alpha) to avoid overplotting:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sns</span><span class="p">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">surveys_complete</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s">"weight"</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">"hindfoot_length"</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</code></pre></div></div>
<p><img src="../fig/seaborn_scatter_alpha.png" alt="" /></p>

<p>We can also add a different colour for all the points:</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sns</span><span class="p">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">surveys_complete</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s">"weight"</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">"hindfoot_length"</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">"red"</span><span class="p">)</span>
</code></pre></div></div>
<p><img src="../fig/seaborn_scatter_alpha_red.png" alt="" /></p>

<p>Or to color each species in the plot differently, we can map the <code class="language-plaintext highlighter-rouge">species_id</code> column to the color (hue):</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sns</span><span class="p">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">surveys_complete</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s">"weight"</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">"hindfoot_length"</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s">"species_id"</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.25</span><span class="p">)</span>
<span class="err">!</span><span class="p">[](..</span><span class="o">/</span><span class="n">fig</span><span class="o">/</span><span class="n">seaborn_scatter_alpha_speciesid</span><span class="p">.</span><span class="n">png</span><span class="p">)</span>
</code></pre></div></div>

<p>Apart from the adaptations of the arguments and settings of the seaborn plot, additional plot-level elements can be added and controlled as well.
Here, it might be useful to have access to plot-level objects like the axes to set things like axes labels and so on. So we will create a figure and axes object
with the built-in matplotlib so we have access to them and then pass them to seaborn for plotting. We will then use these objects to change the label of the x axis and the legend appearance:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="p">.</span><span class="n">add_subplot</span><span class="p">()</span>
<span class="n">sns</span><span class="p">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">surveys_complete</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s">"weight"</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">"hindfoot_length"</span><span class="p">,</span>
                <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s">"species_id"</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">"Weight (g)"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">legend</span><span class="p">(</span><span class="n">ncol</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</code></pre></div></div>
<p><img src="../fig/seaborn_scatter_alpha_speciesid_xlabel.png" alt="" /></p>

<blockquote class="challenge">
  <h2 id="challenge---bar-plots">Challenge - Bar plots</h2>
  <p>Working on the surveys_complete data set, use the plot-id column to create a bar-plot that counts the number of records for each plot.
(Check the documentation of the barplot to handle the counts)</p>

  <p>(see in general [API reference][https://seaborn.pydata.org/api.html] to find the appropriate function).</p>

  <blockquote class="solution">
    <h2 id="answers">Answers</h2>

    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="n">sns</span><span class="p">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">surveys_complete</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s">"plot_id"</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">"weight"</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s">"sex"</span><span class="p">)</span>
</code></pre></div>    </div>

  </blockquote>
</blockquote>

<h2 id="plotting-distributions">Plotting distributions</h2>

<p>Visualizing distributions is a common task during data exploration and
analysis. To visualize the distribution of <code class="language-plaintext highlighter-rouge">weight</code> within each <code class="language-plaintext highlighter-rouge">species_id</code>
group, a boxplot can be used:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sns</span><span class="p">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">surveys_complete</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s">"species_id"</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">"weight"</span><span class="p">)</span>
</code></pre></div></div>
<p><img src="../fig/seaborn_dist.png" alt="" /></p>

<p>By plotting the points of the individual observations, we can have a
better idea of the number of measurements and of their distribution:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sns</span><span class="p">.</span><span class="n">stripplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">surveys_complete</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s">"species_id"</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">"weight"</span><span class="p">)</span>
</code></pre></div></div>
<p><img src="../fig/seaborn_dist_strip.png" alt="" /></p>

<p>Sometimes boxplots can hide the ‘shape’ of the distribution. Violinplots can be used instead.
See the full <a href="https://seaborn.pydata.org/tutorial/distributions.html">tutorial</a>
for plotting distribution data using seaborn including histograms and 2D distributions.</p>

<h2 id="plotting-time-series-data">Plotting time series data</h2>

<p>Let’s calculate number of counts per year for each species. To do that we need
to group data first and count the species (<code class="language-plaintext highlighter-rouge">species_id</code>) within each group.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">yearly_counts</span> <span class="o">=</span> <span class="n">surveys_complete</span><span class="p">.</span><span class="n">groupby</span><span class="p">([</span><span class="s">'year'</span><span class="p">,</span> <span class="s">'species_id'</span><span class="p">])[</span><span class="s">'species_id'</span><span class="p">].</span><span class="n">count</span><span class="p">()</span>
<span class="n">yearly_counts</span>
</code></pre></div></div>

<p>When checking the result of the previous calculation, we actually have both the
<code class="language-plaintext highlighter-rouge">year</code> and the <code class="language-plaintext highlighter-rouge">species_id</code> as a row index. We can reset this index to use both
as column variable:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">yearly_counts</span> <span class="o">=</span> <span class="n">yearly_counts</span><span class="p">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">'counts'</span><span class="p">)</span>
<span class="n">yearly_counts</span>
</code></pre></div></div>

<p>Timelapse data can be visualised as a line plot with years on <code class="language-plaintext highlighter-rouge">x</code>
axis and counts on the <code class="language-plaintext highlighter-rouge">y</code> axis.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sns</span><span class="p">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">yearly_counts</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s">'year'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">'counts'</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s">'species_id'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">legend</span><span class="p">(</span><span class="n">ncol</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</code></pre></div></div>
<p><img src="../fig/seaborn_lineplots.png" alt="" /></p>

<h2 id="faceting">Faceting</h2>

<p>As with other plotting libraries, <code class="language-plaintext highlighter-rouge">seaborn</code> also has a
special technique called <em>faceting</em> that allows to split one plot into multiple
plots based on a factor variable included in the dataset.</p>

<p>Consider our scatter plot of the <code class="language-plaintext highlighter-rouge">weight</code> versus the <code class="language-plaintext highlighter-rouge">hindfoot_length</code> from the
previous sections:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sns</span><span class="p">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">surveys_complete</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s">"weight"</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">"hindfoot_length"</span><span class="p">)</span>
</code></pre></div></div>
<p><img src="../fig/seaborn_scatter.png" alt="" /></p>

<p>We can now keep the same code and at the <code class="language-plaintext highlighter-rouge">facet_wrap</code> on a chosen variable to
split out the graph and make a separate graph for each of the groups in that
variable. As an example, use <code class="language-plaintext highlighter-rouge">sex</code>:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sns</span><span class="p">.</span><span class="n">relplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">surveys_complete</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s">"weight"</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">"hindfoot_length"</span><span class="p">,</span>
            <span class="n">col</span><span class="o">=</span><span class="s">"sex"</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s">"species_id"</span><span class="p">)</span>
</code></pre></div></div>

<p><img src="../fig/seaborn_facet1.png" alt="" /></p>

<p>Note that we switched to the <code class="language-plaintext highlighter-rouge">relplot</code> figure-level function to do the facetting instead of using axis-level functions like
<code class="language-plaintext highlighter-rouge">scatterplot</code> and <code class="language-plaintext highlighter-rouge">lineplot</code>.</p>

<p>We can apply the same concept on any of the available categorical variables:</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sns</span><span class="p">.</span><span class="n">relplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">surveys_complete</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s">"weight"</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">"hindfoot_length"</span><span class="p">,</span>
            <span class="n">col</span><span class="o">=</span><span class="s">"plot_id"</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s">"species_id"</span><span class="p">,</span> <span class="n">col_wrap</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</code></pre></div></div>

<p>Note that we use the <code class="language-plaintext highlighter-rouge">col_wrap</code> parameter to wrap the plots to multiple rows.</p>

<p><img src="../fig/seaborn_facet2.png" alt="" /></p>

<blockquote class="challenge">
  <h2 id="challenge---facetting">Challenge - facetting</h2>
  <p>Create a separate plot for each of the species that depicts how the average
weight of the species changes through the years.</p>

  <blockquote class="solution">
    <h2 id="answers-1">Answers</h2>

    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">yearly_weight</span> <span class="o">=</span> <span class="n">surveys_complete</span><span class="p">.</span><span class="n">groupby</span><span class="p">([</span><span class="s">'year'</span><span class="p">,</span> <span class="s">'species_id'</span><span class="p">])[</span><span class="s">'weight'</span><span class="p">].</span><span class="n">mean</span><span class="p">().</span><span class="n">reset_index</span><span class="p">()</span>

<span class="n">sns</span><span class="p">.</span><span class="n">relplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">yearly_weight</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s">"year"</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">"weight"</span><span class="p">,</span>
            <span class="n">col</span><span class="o">=</span><span class="s">"species_id"</span><span class="p">,</span> <span class="n">col_wrap</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s">"line"</span><span class="p">)</span>

</code></pre></div>    </div>
  </blockquote>
</blockquote>

<blockquote class="challenge">
  <h2 id="challenge---facetting-1">Challenge - facetting</h2>
  <p>Based on the previous exercise, visually compare how the weights of male and
females has changed through time by creating a separate plot for each sex and
an individual color assigned to each <code class="language-plaintext highlighter-rouge">species_id</code>.</p>

  <blockquote class="solution">
    <h2 id="answers-2">Answers</h2>

    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">yearly_weight</span> <span class="o">=</span> <span class="n">surveys_complete</span><span class="p">.</span><span class="n">groupby</span><span class="p">([</span><span class="s">'year'</span><span class="p">,</span> <span class="s">'species_id'</span><span class="p">,</span> <span class="s">'sex'</span><span class="p">])[</span><span class="s">'weight'</span><span class="p">].</span><span class="n">mean</span><span class="p">().</span><span class="n">reset_index</span><span class="p">()</span>


<span class="n">sns</span><span class="p">.</span><span class="n">relplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">yearly_weight</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s">"year"</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">"weight"</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="s">"species_id"</span><span class="p">,</span>
            <span class="n">col_wrap</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s">"line"</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s">"sex"</span><span class="p">)</span>

</code></pre></div>    </div>
  </blockquote>
</blockquote>

<h2 id="further-customization">Further customization</h2>

<p>The plots of seaborn, matplotlib, and other packages in Python can be customised heavily. It takes one look
at the API of your favourite plot function to see the number of parameters it accepts.
Then matplotlib as well on top of that has its own functions to modify its behaviour. In the end, the final look
of the plots is a matter of personal preference or it can be dictated by external factors like publication standards.</p>

<p>Take for example a barchart that plots the counts of surveys per year:</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sns</span><span class="p">.</span><span class="n">countplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">surveys_complete</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s">"year"</span><span class="p">)</span>
</code></pre></div></div>
<p><img src="../fig/countplot.png" alt="" /></p>

<p>Notice that we use the <code class="language-plaintext highlighter-rouge">year</code> here as a categorical variable.
However, by doing so, we have the individual year labels overlapping with each other.
Functions in the <code class="language-plaintext highlighter-rouge">matplotlib</code> axis class provide a way to rotate the text of the x-axis labels:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="p">.</span><span class="n">add_subplot</span><span class="p">()</span>
<span class="n">sns</span><span class="p">.</span><span class="n">countplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">surveys_complete</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s">"year"</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s">'x'</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>
</code></pre></div></div>

<p><img src="../fig/countplot_rot.png" alt="" /></p>

<blockquote class="challenge">
  <h2 id="challenge---customization">Challenge - customization</h2>
  <p>Please take another five minutes to either improve one of the plots
generated in this exercise or create a beautiful graph of your own.</p>

  <p>Here are some ideas:</p>

  <ul>
    <li>See if you can change thickness of lines for the line plot (in the time-series plotting part).</li>
    <li>Can you find a way to change the name of the legend? What about its labels?</li>
    <li>Use a different color palette (see <a href="https://seaborn.pydata.org/tutorial/color_palettes.html">https://seaborn.pydata.org/tutorial/color_palettes.html</a>)</li>
  </ul>
</blockquote>

<p>After creating your plot, you can save it to a file in your favourite format.
You can easily change the dimension (and its resolution) of your plot by
adjusting the appropriate arguments when you create the figure object.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="p">.</span><span class="n">add_subplot</span><span class="p">()</span>
<span class="n">sns</span><span class="p">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">surveys_complete</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s">"weight"</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">"hindfoot_length"</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s">"species_id"</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">savefig</span><span class="p">(</span><span class="s">"scatterplot.png"</span><span class="p">)</span>
</code></pre></div></div>






<blockquote class="keypoints">
  <h2>Key Points</h2>
  <ul>
    
  </ul>
</blockquote>

</article>


















  
  











<div class="row">
  <div class="col-xs-1">
    <h3 class="text-left">
      
      <a href="/03-index-slice-subset/index.html"><span class="glyphicon glyphicon-menu-left" aria-hidden="true"></span><span class="sr-only">previous episode</span></a>
      
    </h3>
  </div>
  <div class="col-xs-10">
    
  </div>
  <div class="col-xs-1">
    <h3 class="text-right">
      
      <a href="/05-loops-and-functions/index.html"><span class="glyphicon glyphicon-menu-right" aria-hidden="true"></span><span class="sr-only">next episode</span></a>
      
    </h3>
  </div>
</div>


      
      






<footer>
  <div class="row">
    <div class="col-md-6 license" id="license-info" align="left">
	
	Licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC-BY 4.0</a> 2018–2023
	by <a href="https://carpentries.org/">The Carpentries</a>
        <br>
        Licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC-BY 4.0</a> 2016–2018
	by <a href="https://datacarpentry.org">Data Carpentry</a>
	
    </div>
    <div class="col-md-6 help-links" align="right">
    
    
    <a href="/edit//_episodes/04-visualization-ggplot-python.md" data-checker-ignore>Edit on GitHub</a>
    
	/
	<a href="/blob//CONTRIBUTING.md" data-checker-ignore>Contributing</a>
	/
	<a href="/">Source</a>
	/
	<a href="/blob//CITATION" data-checker-ignore>Cite</a>
	/
	<a href="mailto:team@carpentries.org">Contact</a>
    </div>
  </div>
  <div class="row">
    <div class="col-md-12" align="center">
      Using <a href="https://github.com/carpentries/styles/">The Carpentries style</a>
      version <a href="https://github.com/carpentries/styles/releases/tag/v9.5.3">9.5.3</a>.
    </div>
  </div>
</footer>

      
    </div>
    
<script src="/assets/js/jquery.min.js"></script>
<script src="/assets/js/bootstrap.min.js"></script>
<script src="/assets/js/lesson.js"></script>


<!-- Matomo -->
<script>
  var _paq = window._paq = window._paq || [];
  /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
  _paq.push(["setDocumentTitle", document.domain + "/" + document.title]);
  _paq.push(["setDomains", ["*.lessons.carpentries.org","*.datacarpentry.github.io","*.datacarpentry.org","*.librarycarpentry.github.io","*.librarycarpentry.org","*.swcarpentry.github.io"]]);
  _paq.push(["setDoNotTrack", true]);
  _paq.push(["disableCookies"]);
  _paq.push(['trackPageView']);
  _paq.push(['enableLinkTracking']);
  (function() {
    var u="https://carpentries.matomo.cloud/";
    _paq.push(['setTrackerUrl', u+'matomo.php']);
    _paq.push(['setSiteId', '1']);
    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
    g.async=true; g.src='//cdn.matomo.cloud/carpentries.matomo.cloud/matomo.js'; s.parentNode.insertBefore(g,s);
  })();
</script>
<!-- End Matomo Code -->


<script src="/assets/js/anchor.min.js"></script>
<script>
    anchors.add();
</script>

  </body>
</html>
